<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>PICKLEBALL SCORE - ƒê·ª®C TR·ªåNG</title>
<style>
  :root{
    --bg:#f4f7fb; --card:#fff; --muted:#6b7280;
    --teamA:#007bff; --teamB:#ff4757;
    --radius:12px;
    --gap:12px;
  }
  /* Reset & base */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);-webkit-text-size-adjust:100%;color:#0f1724}
  a{color:inherit}
  .wrap{
    max-width:980px;
    margin:0 auto;
    padding:14px;
    min-height:100vh;
    display:flex;
    flex-direction:column;
    gap:var(--gap);
  }

  /* Header */
  header{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
  h1{
    margin:0;
    background:#083d9a;
    color:#fff;
    padding:10px 14px;
    border-radius:10px;
    font-size:clamp(16px,3.6vw,20px);
    box-shadow:0 6px 18px rgba(8,61,154,0.12);
  }
  .controls{
    display:flex;
    gap:8px;
    align-items:center;
    flex-wrap:wrap;
  }
  label{font-size:13px;color:var(--muted);display:block}
  select,input{padding:10px;border-radius:10px;border:1px solid #d7dde6;font-size:14px}
  .btn{padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:800;font-size:14px}
  .btn.green{background:#00a850;color:#fff}
  button.small{padding:10px 12px;border-radius:10px;border:0;cursor:pointer;font-weight:800;font-size:14px}

  /* Layout */
  .layout{display:flex;gap:var(--gap);margin-top:4px;align-items:flex-start;flex-wrap:wrap}
  .left{flex:1 1 320px;background:var(--card);padding:12px;border-radius:var(--radius);box-shadow:0 6px 18px rgba(0,0,0,0.06);min-width:260px}
  .right{flex:2 1 420px;background:var(--card);padding:12px;border-radius:var(--radius);box-shadow:0 6px 18px rgba(0,0,0,0.06);min-width:260px}
  .teamBox{padding:10px;border-radius:8px;margin-bottom:10px;border-left:8px solid #ddd;background:#fbfbfb}
  .teamA{border-left-color:var(--teamA)} .teamB{border-left-color:var(--teamB)}
  .small{font-size:13px;color:var(--muted)}
  .bigScore{font-size:clamp(22px,6vw,36px);font-weight:900}

  /* Court responsive */
  .courtWrap{display:flex;justify-content:center;align-items:center;padding:8px}
  .court{
    width:100%;
    /* height scales with width to keep good mobile aspect */
    height:calc(min(560px, 85vw) * 0.55);
    max-height:520px;
    background:#d7f0d9;
    border:4px solid #2b4b2b;
    border-radius:10px;
    position:relative;
    display:flex;
    overflow:hidden;
  }

  /* center net */
  .net{position:absolute;left:50%;top:0;bottom:0;width:6px;background:#333;transform:translateX(-50%)}
  .nvz-left{position:absolute;left:43%;top:0;bottom:0;width:14%;background:rgba(255,200,0,0.12);border-left:2px dashed rgba(0,0,0,0.08);border-right:2px dashed rgba(0,0,0,0.08)}
  .nvz-right{position:absolute;left:50%;width:14%;top:0;bottom:0;background:rgba(255,200,0,0.12);border-left:2px dashed rgba(0,0,0,0.08);border-right:2px dashed rgba(0,0,0,0.08);transform:translateX(0)}

  /* Player boxes */
  .player{
    position:absolute;
    width:46%;
    height:46px;
    border-radius:10px;
    background:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:800;
    border:2px solid rgba(0,0,0,0.06);
    transition:transform .14s, box-shadow .14s;
    font-size:14px;
    padding:6px;
  }
  .teamAcolor{color:var(--teamA);border-color:rgba(0,123,255,0.12)}
  .teamBcolor{color:var(--teamB);border-color:rgba(255,71,87,0.12)}
  .server{background:#ffdede;border-color:#ff5b5b !important;color:#7a0000;transform:scale(1.06);box-shadow:0 12px 28px rgba(0,0,0,0.12)}

  /* A-side positions (left half) */
  #A-near{left:5%; top:30%}    /* near net (ph·∫£i) */
  #A-far {left:5%; bottom:30%}  /* far from net (tr√°i) */

  /* B-side positions (right half) */
  #B-near{right:5%; top:30%}   /* near net (ph·∫£i) */
  #B-far {right:5%; bottom:30%} /* far from net ('tr√°i') */

  .board{margin-top:12px;text-align:center}
  .mainBoard{display:inline-block;background:#fff;padding:8px 14px;border-radius:8px;font-weight:900}
  .controlsRow{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .muted{color:var(--muted);font-size:13px}
  .flex-between{display:flex;justify-content:space-between;align-items:center}

  /* Mobile-first adjustments */
  @media (max-width:880px){
    .layout{flex-direction:column}
    .left{order:2}
    .right{order:1}
    header{align-items:flex-start}
    .controls{width:100%;justify-content:flex-start}
    .court{height:calc(75vw * 0.55)}
    .player{height:48px;font-size:15px}
    .btn, .btn.green{width:100%}
  }

  /* Larger screens */
  @media (min-width:1200px){
    .wrap{padding:20px}
    .court{height:360px}
  }

  /* make inputs full width inside small containers */
  .teamBox input.small{width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid #e6e9ee}
  .teamBox .small{margin-bottom:6px}
  /* touch target improvements */
  button, select, input{touch-action:manipulation}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>PICKLEBALL SCORE - ƒê·ª®C TR·ªåNG</h1>
    <div class="controls" style="min-width:200px">
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <label class="small" style="margin-right:4px">Thang</label>
        <select id="pointType" aria-label="Thang ƒëi·ªÉm"><option value="11">11</option><option value="15">15</option></select>
      </div>

      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <label class="small" style="margin-right:4px">Ki·ªÉu</label>
        <select id="winType" aria-label="Ki·ªÉu th·∫Øng"><option value="touch">Ch·∫°m</option><option value="by2">C√°ch 2</option></select>
      </div>

      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <label class="small" style="margin-right:4px">Giao</label>
        <select id="firstServe" aria-label="ƒê·ªôi giao ƒë·∫ßu"><option value="A">A</option><option value="B">B</option></select>
      </div>

      <div style="min-width:120px">
        <button class="btn green" onclick="startMatch()">B·∫ÆT ƒê·∫¶U</button>
      </div>
    </div>
  </header>

  <div class="layout">
    <!-- RIGHT (on mobile appears first) -->
    <div class="right">
      <div class="flex-between">
        <div style="font-weight:900">S√¢n (ngang)</div>
        <div style="text-align:right">
          <div class="small">Server</div>
          <div id="serverInfo" style="font-weight:900">-</div>
        </div>
      </div>

      <div class="courtWrap" style="margin-top:10px">
        <div class="court" id="court" role="img" aria-label="S√¢n pickleball">
          <div class="nvz-left" aria-hidden="true"></div>
          <div class="net" aria-hidden="true"></div>
          <div class="nvz-right" aria-hidden="true"></div>

          <!-- A side (left half) -->
          <div id="A-near" class="player teamAcolor">A - Near</div>
          <div id="A-far"  class="player teamAcolor">A - Far</div>

          <!-- B side (right half) -->
          <div id="B-near" class="player teamBcolor">B - Near</div>
          <div id="B-far"  class="player teamBcolor">B - Far</div>
        </div>
      </div>

      <div style="display:flex;gap:10px;justify-content:space-between;margin-top:14px;flex-wrap:wrap">
        <div style="flex:1 1 45%;text-align:center">
          <div style="font-weight:900;color:var(--teamA)"><span id="lblA">ƒê·ªôi A</span></div>
          <div style="margin-top:8px;display:flex;flex-direction:column;gap:8px">
            <button class="btn small" onclick="servePoint('A')">+ ƒêi·ªÉm (A n·∫øu ƒëang giao)</button>
            <button class="btn small" onclick="receiverWins('A')">Receiver wins</button>
            <button class="btn small" onclick="decPoint('A')">‚àí</button>
          </div>
        </div>

        <div style="flex:1 1 45%;text-align:center">
          <div style="font-weight:900;color:var(--teamB)"><span id="lblB">ƒê·ªôi B</span></div>
          <div style="margin-top:8px;display:flex;flex-direction:column;gap:8px">
            <button class="btn small" onclick="servePoint('B')">+ ƒêi·ªÉm (B n·∫øu ƒëang giao)</button>
            <button class="btn small" onclick="receiverWins('B')">Receiver wins</button>
            <button class="btn small" onclick="decPoint('B')">‚àí</button>
          </div>
        </div>
      </div>

      <div style="display:flex;gap:8px;justify-content:center;margin-top:12px;flex-wrap:wrap">
        <button class="btn" onclick="manualSideOut()">Side-out th·ªß c√¥ng</button>
        <button class="btn" onclick="showState()">Hi·ªán tr·∫°ng</button>
      </div>
    </div>

    <!-- LEFT: settings -->
    <div class="left">
      <div class="teamBox teamA">
        <div class="flex-between">
          <div>
            <div style="font-weight:900">ƒê·ªôi A</div>
            <div class="small">T√™n ƒë·ªôi: <input id="teamAName" class="small" value="TEAM A" aria-label="T√™n ƒë·ªôi A"></div>
          </div>
          <div style="text-align:right">
            <div class="small">ƒêi·ªÉm</div>
            <div id="scoreA" class="bigScore">0</div>
          </div>
        </div>
        <div style="margin-top:8px">
          <div class="small">VƒêV (ph·∫£i = NGAY G·∫¶N L∆Ø·ªöI / tr√°i = XA L∆Ø·ªöI)</div>
          <input id="A_right" class="small" value="A - Ph·∫£i" style="width:100%;margin-top:6px" aria-label="A ph·∫£i">
          <input id="A_left"  class="small" value="A - Tr√°i" style="width:100%;margin-top:6px" aria-label="A tr√°i">
        </div>
      </div>

      <div class="teamBox teamB">
        <div class="flex-between">
          <div>
            <div style="font-weight:900">ƒê·ªôi B</div>
            <div class="small">T√™n ƒë·ªôi: <input id="teamBName" class="small" value="TEAM B" aria-label="T√™n ƒë·ªôi B"></div>
          </div>
          <div style="text-align:right">
            <div class="small">ƒêi·ªÉm</div>
            <div id="scoreB" class="bigScore">0</div>
          </div>
        </div>
        <div style="margin-top:8px">
          <div class="small">VƒêV (ph·∫£i = NGAY G·∫¶N L∆Ø·ªöI / tr√°i = XA L∆Ø·ªöI)</div>
          <input id="B_right" class="small" value="B - Ph·∫£i" style="width:100%;margin-top:6px" aria-label="B ph·∫£i">
          <input id="B_left"  class="small" value="B - Tr√°i" style="width:100%;margin-top:6px" aria-label="B tr√°i">
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="muted">B·∫£ng ch√≠nh: <span class="small">(ƒëi·ªÉm ƒë·ªôi ƒëang giao - ƒëi·ªÉm ƒë·ªëi ph∆∞∆°ng - S)</span></div>
        <div class="board" style="margin-top:8px"><div id="mainBoard" class="mainBoard">0 - 0 - 0</div></div>
        <div style="margin-top:8px" class="muted">Ghi ch√∫: ƒë·ªôi giao ƒë·∫ßu tr·∫≠n <b>b·∫Øt ƒë·∫ßu S=1</b> theo lu·∫≠t ti√™u chu·∫©n; khi serve chuy·ªÉn sang ƒë·ªôi kh√°c th√¨ ƒë·ªôi ƒë√≥ c√≥ S=2.</div>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== State ===== */
let scoreA = 0, scoreB = 0;
let servingTeam = null;      // 'A' or 'B'
let S = 0;                   // s·ªë l∆∞·ª£t giao c√≤n l·∫°i cho ƒë·ªôi ƒëang giao (1 ho·∫∑c 2)
let initialTeam = null;      // ƒë·ªôi giao ƒë·∫ßu tr·∫≠n (ch·ªâ c√≥ 1 quy·ªÅn)
let serverIndex = { A: 0, B: 0 }; // which player index currently on NEAR/RIGHT: 0 = right/near, 1 = left/far
let matchOn = false;

/* DOM helpers */
const $ = id => document.getElementById(id);

/* Start match */
function startMatch(){
  // load names
  $('A-near').textContent = $('A_right').value || 'A - Ph·∫£i';
  $('A-far').textContent  = $('A_left').value  || 'A - Tr√°i';
  $('B-near').textContent = $('B_right').value || 'B - Ph·∫£i';
  $('B-far').textContent  = $('B_left').value  || 'B - Tr√°i';
  $('lblA').textContent = $('teamAName').value || 'ƒê·ªôi A';
  $('lblB').textContent = $('teamBName').value || 'ƒê·ªôi B';

  // init
  scoreA = 0; scoreB = 0;
  initialTeam = $('firstServe').value || 'A';
  servingTeam = initialTeam;

  S = 1; // initial serving team has S = 1
  serverIndex.A = 0;
  serverIndex.B = 0;

  matchOn = true;
  updateUI();
  try { alert('Tr·∫≠n b·∫Øt ƒë·∫ßu. ƒê·ªôi ' + servingTeam + ' giao tr∆∞·ªõc (ƒë·ªôi ƒë·∫ßu tr·∫≠n S=1). B·∫£ng: ' + boardText()); } catch(e){}
}

/* Build board text X - Y - S from serving team perspective */
function boardText(){
  if(!matchOn) return `${scoreA} - ${scoreB} - ${S}`;
  const sScore = (servingTeam === 'A') ? scoreA : scoreB;
  const oScore = (servingTeam === 'A') ? scoreB : scoreA;
  return `${sScore} - ${oScore} - ${S}`;
}

/* Update UI visuals */
function updateUI(){
  // scores
  $('scoreA').textContent = scoreA;
  $('scoreB').textContent = scoreB;
  $('mainBoard').textContent = boardText();
  $('serverInfo').textContent = matchOn ? (servingTeam + ' ‚Äî ' + ((serverIndex[servingTeam]===0)?'Ph·∫£i (g·∫ßn l∆∞·ªõi)':'Tr√°i (xa l∆∞·ªõi)')) : '-';

  // update player names (in case edited)
  $('A-near').textContent = $('A_right').value || 'A - Ph·∫£i';
  $('A-far').textContent  = $('A_left').value  || 'A - Tr√°i';
  $('B-near').textContent = $('B_right').value || 'B - Ph·∫£i';
  $('B-far').textContent  = $('B_left').value  || 'B - Tr√°i';

  // remove server highlight
  ['A-near','A-far','B-near','B-far'].forEach(id => $(id).classList.remove('server'));
  // add server highlight (player who is currently serving)
  if(matchOn){
    const team = servingTeam;
    const idx  = serverIndex[team]; // 0 = near, 1 = far
    const id = (team === 'A' ? (idx===0 ? 'A-near' : 'A-far') : (idx===0 ? 'B-near' : 'B-far'));
    $(id).classList.add('server');
  }
}

/* Serve point: only valid when team === servingTeam */
function servePoint(team){
  if(!matchOn){ alert('B·∫•m B·∫ÆT ƒê·∫¶U tr∆∞·ªõc khi ghi ƒëi·ªÉm.'); return; }
  if(team !== servingTeam){ alert('Ch·ªâ ƒë·ªôi ƒëang giao m·ªõi ƒë∆∞·ª£c c·ªông ƒëi·ªÉm. N·∫øu ƒë·ªôi nh·∫≠n th·∫Øng pha, b·∫•m "Receiver wins" cho h·ªç.'); return; }

  // +1 point
  if(team === 'A') scoreA++; else scoreB++;

  // server (the player currently in near position) switches side: near <-> far
  serverIndex[team] = 1 - serverIndex[team];

  // when serving team scores, S does NOT change
  updateUI();
  checkWin();
}

/* Receiver wins rally */
function receiverWins(winnerTeam){
  if(!matchOn){ alert('B·∫Øt ƒë·∫ßu tr·∫≠n tr∆∞·ªõc (B·∫ÆT ƒê·∫¶U).'); return; }
  if(winnerTeam === servingTeam){
    alert('ƒê·ªôi n√†y ƒëang giao. N·∫øu h·ªç ghi ƒëi·ªÉm, b·∫•m + ƒêi·ªÉm (Serve).');
    return;
  }

  if(S === 2){
    S = 1;
    serverIndex[servingTeam] = 1 - serverIndex[servingTeam];
  } else if(S === 1){
    servingTeam = winnerTeam;
    S = 2;
    serverIndex[servingTeam] = 0;
  } else {
    servingTeam = winnerTeam;
    S = 2;
    serverIndex[servingTeam] = 0;
  }

  updateUI();
}

/* Manual side-out (for correction) */
function manualSideOut(){
  if(!matchOn){ alert('B·∫Øt ƒë·∫ßu tr·∫≠n tr∆∞·ªõc (B·∫ÆT ƒê·∫¶U).'); return; }
  servingTeam = (servingTeam === 'A') ? 'B' : 'A';
  S = 2;
  serverIndex[servingTeam] = 0;
  updateUI();
}

/* Manual decrement point */
function decPoint(team){
  if(team === 'A' && scoreA>0) scoreA--;
  if(team === 'B' && scoreB>0) scoreB--;
  updateUI();
}

/* Check win conditions */
function checkWin(){
  const pt = $('pointType').value; // '11' or '15'
  const winType = $('winType').value; // 'touch' or 'by2'
  const cap = (pt === '11') ? 15 : 21;
  const target = (winType === 'touch') ? Number(pt) : Number(cap);

  if(scoreA >= target || scoreB >= target){
    if(winType === 'by2'){
      if(Math.abs(scoreA - scoreB) >= 2 || scoreA >= cap || scoreB >= cap){
        announceWinner();
      }
    } else {
      announceWinner();
    }
  }
}

function announceWinner(){
  const winner = (scoreA > scoreB) ? ($('teamAName').value || 'ƒê·ªôi A') : ($('teamBName').value || 'ƒê·ªôi B');
  alert('üéâ ' + winner + ' th·∫Øng tr·∫≠n! üéâ');
  matchOn = false;
  updateUI();
}

/* Debug / show state */
function showState(){
  alert(`State:
matchOn: ${matchOn}
initialTeam: ${initialTeam}
servingTeam: ${servingTeam}
S (serves remaining for serving team): ${S}
serverIndex (0=near/right,1=far/left): A=${serverIndex.A}, B=${serverIndex.B}
scoreA - scoreB: ${scoreA} - ${scoreB}`);
}

/* Initialize UI */
updateUI();
</script>
</body>
</html>
