<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>PICKLEBALL SCORE - ĐỨC TRỌNG</title>

<style>
    body {
        font-family: Arial;
        margin: 0;
        background: #e6f2ff;
        padding: 10px;
        user-select: none;
    }
    h2 {
        text-align: center;
        margin: 5px 0 10px 0;
        color: #004a94;
        text-shadow: 1px 1px 2px #999;
    }
    .config-box {
        background: white;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 0 4px #aaa;
        margin-bottom: 10px;
    }
    label { font-weight: bold; }
    input, select { padding: 6px; width: 100%; margin-top: 4px; }

    .court {
        width: 100%;
        max-width: 600px;
        height: 260px;
        background: #c8f7c5;
        margin: auto;
        position: relative;
        border: 4px solid #006400;
        display: flex;
    }
    .half {
        width: 50%;
        border-right: 2px solid #000;
        position: relative;
    }
    .nvz {
        position: absolute;
        top: 35%;
        height: 30%;
        width: 100%;
        background: rgba(255,165,0,0.25);
        border-top: 2px dashed #ff8c00;
        border-bottom: 2px dashed #ff8c00;
    }
    .player {
        position: absolute;
        width: 48%;
        height: 48%;
        background: #fff;
        border-radius: 8px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 14px;
        font-weight: bold;
        border: 2px solid black;
    }

    .teamA { border-color: #007bff; }
    .teamB { border-color: #ff4757; }
    .server { background: #ffb3b3 !important; border-color: red !important; }

    /* A-side */
    #A-right { left: 2%; top: 2%; }
    #A-left  { left: 2%; bottom: 2%; }

    /* B-side */
    #B-right { right: 2%; top: 2%; }
    #B-left  { right: 2%; bottom: 2%; }

    .scoreboard {
        text-align: center;
        margin-top: 10px;
        font-size: 24px;
        font-weight: bold;
    }

    .team-controls {
        display: flex;
        justify-content: space-between;
        margin-top: 10px;
    }
    .team-box {
        width: 48%;
        background: white;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 0 4px #aaa;
    }
    button {
        width: 48%;
        padding: 10px;
        font-size: 18px;
        font-weight: bold;
        border: none;
        border-radius: 8px;
        background: #0088ff;
        color: white;
    }
    .minus { background: #ff3b30; }
</style>
</head>
<body>

<h2>PICKLEBALL SCORE - ĐỨC TRỌNG</h2>

<div class="config-box">
    <label>Tên đội A</label>
    <input id="teamAName" value="Team A">

    <label>VĐV A (phải - trái)</label>
    <input id="A1" value="A-Right">
    <input id="A2" value="A-Left">

    <br><br>
    <label>Tên đội B</label>
    <input id="teamBName" value="Team B">

    <label>VĐV B (phải - trái)</label>
    <input id="B1" value="B-Right">
    <input id="B2" value="B-Left">

    <br><br>
    <label>Thang điểm</label>
    <select id="target">
        <option value="11">11 điểm</option>
        <option value="15">15 điểm</option>
    </select>

    <label>Cách thắng</label>
    <select id="mode">
        <option value="touch">Chạm điểm</option>
        <option value="winBy2">Cách 2 điểm</option>
    </select>

    <label>Đội giao banh đầu tiên</label>
    <select id="firstServeTeam">
        <option value="A">Đội A</option>
        <option value="B">Đội B</option>
    </select>

    <button style="width:100%;margin-top:10px;background:#28a745"
            onclick="startMatch()">BẮT ĐẦU TRẬN</button>
</div>

<div class="court">
    <div class="half">
        <div class="nvz"></div>
        <div id="A-right" class="player teamA"></div>
        <div id="A-left" class="player teamA"></div>
    </div>
    <div class="half">
        <div class="nvz"></div>
        <div id="B-right" class="player teamB"></div>
        <div id="B-left" class="player teamB"></div>
    </div>
</div>

<div class="scoreboard" id="mainScore">0 - 0 - 2</div>

<div class="team-controls">
    <div class="team-box">
        <h3 id="AnameBox">Team A</h3>
        <button onclick="addPoint('A')">+ A</button>
        <button class="minus" onclick="subPoint('A')">- A</button>
    </div>
    <div class="team-box">
        <h3 id="BnameBox">Team B</h3>
        <button onclick="addPoint('B')">+ B</button>
        <button class="minus" onclick="subPoint('B')">- B</button>
    </div>
</div>

<script>
/* ===== BIẾN TRẠNG THÁI ===== */
let scoreA = 0, scoreB = 0;
let servingTeam = "A";    // A hoặc B
let serveNumber = 2;      // 1 hoặc 2
let rightServer = { A: true, B: true }; // true=đứng phải, false=đứng trái
let servedFirst = "";     // A hoặc B

function startMatch() {
    scoreA = scoreB = 0;

    servingTeam = document.getElementById("firstServeTeam").value;
    servedFirst = servingTeam;

    serveNumber = 2; // đội giao đầu tiên luôn 2

    document.getElementById("AnameBox").innerText = document.getElementById("teamAName").value;
    document.getElementById("BnameBox").innerText = document.getElementById("teamBName").value;

    updatePlayers();
    updateBoard();
}

/* ===== HIỂN THỊ VĐV ===== */
function updatePlayers() {
    document.getElementById("A-right").innerText = document.getElementById("A1").value;
    document.getElementById("A-left").innerText  = document.getElementById("A2").value;
    document.getElementById("B-right").innerText = document.getElementById("B1").value;
    document.getElementById("B-left").innerText  = document.getElementById("B2").value;

    document.querySelectorAll(".player").forEach(p => p.classList.remove("server"));

    if (servingTeam === "A") {
        document.getElementById(rightServer.A ? "A-right" : "A-left").classList.add("server");
    } else {
        document.getElementById(rightServer.B ? "B-right" : "B-left").classList.add("server");
    }
}

/* ===== CẬP NHẬT BẢNG CHÍNH ===== */
function updateBoard() {
    let X = servingTeam === "A" ? scoreA : scoreB;
    let Y = servingTeam === "A" ? scoreB : scoreA;
    document.getElementById("mainScore").innerText = `${X} - ${Y} - ${serveNumber}`;
    updatePlayers();
}

/* ===== THÊM ĐIỂM ===== */
function addPoint(team) {
    if (team !== servingTeam) {
        lossOfServe();
        return;
    }

    if (team === "A") scoreA++;
    else scoreB++;

    /* Người giao đổi vị trí */
    rightServer[team] = !rightServer[team];

    checkWin();
    updateBoard();
}

/* ===== TRỪ ĐIỂM (không ảnh hưởng luật giao) ===== */
function subPoint(team) {
    if (team === "A" && scoreA > 0) scoreA--;
    if (team === "B" && scoreB > 0) scoreB--;
    updateBoard();
}

/* ===== MẤT QUYỀN GIAO ===== */
function lossOfServe() {
    if (servingTeam === servedFirst) {
        serveNumber = 1;
        servedFirst = ""; // từ đây trở đi dùng hệ 1–2 bình thường
    } else if (serveNumber === 1) {
        serveNumber = 2;
    } else {
        servingTeam = servingTeam === "A" ? "B" : "A";
        serveNumber = 1;
    }
    updateBoard();
}

/* ===== KIỂM TRA THẮNG ===== */
function checkWin() {
    let target = parseInt(document.getElementById("target").value);
    let mode = document.getElementById("mode").value;

    let winScore = target;
    if (mode === "winBy2") {
        winScore = target === 11 ? 15 : 21;
    }

    if (scoreA >= winScore || scoreB >= winScore) {
        alert("Đội thắng: " + (scoreA > scoreB ?
              document.getElementById("teamAName").value :
              document.getElementById("teamBName").value));
    }
}
</script>

</body>
</html>
