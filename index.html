<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>PICKLEBALL SCORE - Äá»¨C TRá»ŒNG</title>
<style>
  :root{
    --bg:#f3f6f9; --card:#ffffff;
    --teamA:#ff6b6b; --teamB:#2ba6ff;
    --muted:#6b7280;
  }
  html,body{height:100%; margin:0; font-family:Inter, "Segoe UI", Roboto, Arial; background:var(--bg); -webkit-text-size-adjust:100%;}
  .app{max-width:920px; margin:18px auto; padding:14px; box-sizing:border-box;}
  header{display:flex; align-items:center; justify-content:space-between; gap:12px;}
  h1{margin:0; font-size:18px; color:#fff; background:#0047c2; padding:10px 14px; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.12);}
  .controls{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
  .controls label{font-size:13px; color:var(--muted); margin-right:6px;}
  select,input[type="text"]{padding:8px 10px; border-radius:8px; border:1px solid #d0d7de; font-size:13px;}
  .btn {padding:9px 12px; border-radius:8px; border:none; cursor:pointer; font-weight:600;}
  .btn.green{background:#00a14b;color:#fff;}
  .layout{display:flex; gap:12px; margin-top:12px;}
  .leftCol{width:360px; background:var(--card); border-radius:10px; padding:12px; box-shadow:0 6px 18px rgba(15,23,42,0.06);}
  .rightCol{flex:1; background:var(--card); border-radius:10px; padding:12px; box-shadow:0 6px 18px rgba(15,23,42,0.06);}
  .teamBox{display:flex; align-items:center; justify-content:space-between; background:#fbfbfb; padding:10px; border-radius:8px; margin-bottom:10px; border-left:8px solid;}
  .teamA{border-left-color:var(--teamA)} .teamB{border-left-color:var(--teamB)}
  .teamInfo{display:flex; gap:8px; align-items:center;}
  .small{font-size:12px; color:var(--muted)}
  .scoreBig{font-size:28px; font-weight:800; letter-spacing:1px;}
  .scoreButtons button{margin-left:6px;}
  .courtWrap{display:flex; justify-content:center; align-items:center; padding:8px;}
  /* court */
  .court{width:320px; height:520px; background:#cfefd3; border:3px solid #334; border-radius:8px; position:relative; box-shadow:inset 0 0 0 6px rgba(255,255,255,0.06);}
  .net{position:absolute; left:0; right:0; top:50%; height:6px; background:#444;}
  .kitchen.top{position:absolute; left:0; right:0; top:50%; height:72px; transform:translateY(-72px); border-top:2px dashed rgba(0,0,0,0.25); border-bottom:2px dashed rgba(0,0,0,0.25); background: rgba(255,255,0,0.06);}
  .kitchen.bottom{position:absolute; left:0; right:0; bottom:50%; height:72px; transform:translateY(72px); border-top:2px dashed rgba(0,0,0,0.25); border-bottom:2px dashed rgba(0,0,0,0.25); background: rgba(255,255,0,0.06);}
  .player{position:absolute; width:120px; height:36px; line-height:36px; border-radius:6px; text-align:center; font-weight:700; box-shadow:0 6px 14px rgba(0,0,0,0.08); border:2px solid rgba(0,0,0,0.06);}
  /* default positions */
  #A_right { right:14px; bottom:40px; }
  #A_left  { left:14px; bottom:40px; }
  #B_right { right:14px; top:40px; }
  #B_left  { left:14px; top:40px; }

  .A{background:#fff0f0; border-color:var(--teamA); color:var(--teamA)}
  .B{background:#f0faff; border-color:var(--teamB); color:var(--teamB)}
  .centerInfo{display:flex; align-items:center; gap:8px; flex-direction:column; padding:6px;}
  .bigBoard{font-size:24px; font-weight:900; background:#fff; padding:8px 12px; border-radius:8px;}
  .footerNote{font-size:12px; color:var(--muted); margin-top:8px;}
  input.smallInput{width:110px; padding:7px; font-size:13px;}

  /* compact on small screens */
  @media (max-width:880px){
    .layout{flex-direction:column;}
    .leftCol{width:100%;}
    .court{transform:scale(0.92);}
  }
</style>
</head>
<body>
<div class="app">
  <header>
    <h1>PICKLEBALL SCORE - Äá»¨C TRá»ŒNG</h1>
    <div class="controls">
      <label class="small">Äiá»ƒm:</label>
      <select id="pointType" title="Chá»n thang Ä‘iá»ƒm">
        <option value="11">11 Ä‘iá»ƒm</option>
        <option value="15">15 Ä‘iá»ƒm</option>
      </select>

      <label class="small">Kiá»ƒu tháº¯ng:</label>
      <select id="winType" title="Cháº¡m Ä‘iá»ƒm hoáº·c cÃ¡ch 2">
        <option value="touch">Cháº¡m Ä‘iá»ƒm</option>
        <option value="winby2">CÃ¡ch 2 Ä‘iá»ƒm</option>
      </select>

      <label class="small">Äá»™i giao Ä‘áº§u:</label>
      <select id="firstServe" title="Äá»™i giao banh Ä‘áº§u tiÃªn">
        <option value="A">Äá»™i A</option>
        <option value="B">Äá»™i B</option>
      </select>

      <button class="btn green" onclick="startMatch()">Báº®T Äáº¦U</button>
    </div>
  </header>

  <div class="layout">
    <!-- LEFT: settings + scoreboard -->
    <div class="leftCol">
      <div class="teamBox teamA">
        <div class="teamInfo">
          <div style="display:flex;flex-direction:column;">
            <div style="font-weight:800;">Äá»™i A</div>
            <div class="small">TÃªn Ä‘á»™i: <input class="smallInput" id="teamAName" value="TEAM A"></div>
          </div>
          <div style="display:flex;flex-direction:column; gap:6px;">
            <div>
              <input id="A_p1" class="smallInput" value="A - Pháº£i">
              <input id="A_p2" class="smallInput" value="A - TrÃ¡i" style="margin-left:6px">
            </div>
            <div class="small">Vá»‹ trÃ­: pháº£i = ngÆ°á»i giao Ä‘áº§u tiÃªn</div>
          </div>
        </div>
      </div>

      <div class="teamBox teamB">
        <div class="teamInfo">
          <div style="display:flex;flex-direction:column;">
            <div style="font-weight:800;">Äá»™i B</div>
            <div class="small">TÃªn Ä‘á»™i: <input class="smallInput" id="teamBName" value="TEAM B"></div>
          </div>
          <div style="display:flex;flex-direction:column; gap:6px;">
            <div>
              <input id="B_p1" class="smallInput" value="B - Pháº£i">
              <input id="B_p2" class="smallInput" value="B - TrÃ¡i" style="margin-left:6px">
            </div>
            <div class="small">Vá»‹ trÃ­: pháº£i = ngÆ°á»i giao Ä‘áº§u tiÃªn</div>
          </div>
        </div>
      </div>

      <div style="margin-top:8px; display:flex; gap:8px; align-items:center; justify-content:space-between;">
        <div>
          <div class="small">Báº£ng Ä‘iá»ƒm chÃ­nh</div>
          <div class="bigBoard" id="mainBoard">0 - 0 - 0</div>
          <div class="footerNote">CÃº phÃ¡p: Äiá»ƒm A - Äiá»ƒm B - Sá»‘ lÆ°á»£t giao cÃ²n láº¡i cá»§a Ä‘á»™i Ä‘ang giao</div>
        </div>

        <div style="text-align:right;">
          <div class="small">Äiá»ƒm hiá»ƒn thá»‹</div>
          <div class="scoreBig" id="scoreDisplay">0 - 0</div>
          <div style="margin-top:6px;">
            <button class="btn" onclick="resetPositions()">Äáº·t láº¡i vá»‹ trÃ­</button>
          </div>
        </div>
      </div>

      <div style="margin-top:12px;">
        <div class="small">Ghi chÃº tÃ³m táº¯t:</div>
        <ul style="margin:6px 0 0 18px; color:var(--muted); font-size:13px; line-height:1.4;">
          <li>Chá»‰ Ä‘á»™i Ä‘ang giao má»›i Ä‘Æ°á»£c cá»™ng Ä‘iá»ƒm.</li>
          <li>Äá»™i Ä‘áº§u tráº­n chá»‰ cÃ³ 1 quyá»n giao; cÃ¡c Ä‘á»™i sau cÃ³ 2 quyá»n giao (má»—i quyá»n do 1 thÃ nh viÃªn).</li>
          <li>Má»—i láº§n Ä‘á»™i Ä‘ang giao ghi Ä‘iá»ƒm â†’ ngÆ°á»i giao Ä‘á»•i trÃ¡i/pháº£i.</li>
        </ul>
      </div>
    </div>

    <!-- RIGHT: court + controls -->
    <div class="rightCol">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
        <div style="font-weight:800;">SÃ¢n & Vá»‹ trÃ­</div>
        <div style="display:flex; gap:8px; align-items:center;">
          <div class="small">Äiá»ƒm A</div><div id="scoreAmini" style="font-weight:900">0</div>
          <div style="width:6px"></div>
          <div class="small">Äiá»ƒm B</div><div id="scoreBmini" style="font-weight:900">0</div>
        </div>
      </div>

      <div class="courtWrap">
        <div class="court" id="court">
          <div class="kitchen top"></div>
          <div class="net"></div>
          <div class="kitchen bottom"></div>

          <!-- player boxes -->
          <div id="B_right" class="player B">B2</div>
          <div id="B_left"  class="player B">B1</div>
          <div id="A_right" class="player A">A2</div>
          <div id="A_left"  class="player A">A1</div>
        </div>
      </div>

      <div style="display:flex; gap:10px; justify-content:center; margin-top:12px; align-items:center;">
        <div style="display:flex; flex-direction:column; align-items:center;">
          <div style="font-weight:800; color:var(--teamA)">Äá»™i A</div>
          <div style="margin-top:6px;">
            <button class="btn" onclick="pointButton('A')">+ Äiá»ƒm</button>
            <button class="btn" onclick="minusPoint('A')">âˆ’ Äiá»ƒm</button>
          </div>
        </div>

        <div style="display:flex; flex-direction:column; align-items:center;">
          <div style="font-weight:800; color:var(--teamB)">Äá»™i B</div>
          <div style="margin-top:6px;">
            <button class="btn" onclick="pointButton('B')">+ Äiá»ƒm</button>
            <button class="btn" onclick="minusPoint('B')">âˆ’ Äiá»ƒm</button>
          </div>
        </div>
      </div>

      <div style="display:flex; justify-content:center; gap:10px; margin-top:12px;">
        <button class="btn" onclick="swapServe()">Chuyá»ƒn quyá»n giao thá»§ cÃ´ng</button>
        <button class="btn" onclick="showState()">Hiá»‡n tráº¡ng</button>
      </div>

    </div>
  </div>
</div>

<script>
/* Tráº¡ng thÃ¡i chÃ­nh */
let scoreA = 0, scoreB = 0;
let servingTeam = 'A';       // 'A' hoáº·c 'B' = Ä‘á»™i hiá»‡n Ä‘ang giao
let servingPlayer = 1;       // 1 = ngÆ°á»i bÃªn pháº£i (giao Ä‘áº§u), 2 = ngÆ°á»i bÃªn trÃ¡i
let initialServer = 'A';     // Ä‘á»™i Ä‘Æ°á»£c chá»n giao Ä‘áº§u
let isMatchStarted = false;
let isInitialPhase = true;   // Ä‘á»™i Ä‘áº§u tráº­n chá»‰ cÃ³ 1 quyá»n; sau láº§n máº¥t quyá»n Ä‘áº§u tiÃªn -> false
let serviceRights = 1;       // sá»‘ lÆ°á»£t giao cÃ²n láº¡i cho Ä‘á»™i Ä‘ang giao (1 hoáº·c 2)
let maxPoint = 11, capPoint = 15, winBy2 = false;

/* UI helpers */
function $(id){return document.getElementById(id);}
function startMatch(){
  // Ä‘á»c setting
  initialServer = $('firstServe').value;
  servingTeam = initialServer;
  servingPlayer = 1; // pháº£i giao Ä‘áº§u
  isMatchStarted = true;
  isInitialPhase = true;
  serviceRights = 1; // Ä‘á»™i Ä‘áº§u chá»‰ cÃ³ 1 quyá»n
  let pt = document.getElementById('pointType').value;
  maxPoint = (pt === '11')?11:15;
  capPoint = (pt === '11')?15:21;
  winBy2 = (document.getElementById('winType').value === 'winby2');

  // reset scores
  scoreA = 0; scoreB = 0;
  updateNames();
  updateAll();
  alert('Tráº­n báº¯t Ä‘áº§u â€” Äá»™i ' + servingTeam + ' giao trÆ°á»›c (Ä‘á»™i Ä‘áº§u tráº­n chá»‰ cÃ³ 1 quyá»n giao).');
}

/* update names from inputs */
function updateNames(){
  $('A_left').textContent = $('A_p2').value || 'A - TrÃ¡i';
  $('A_right').textContent = $('A_p1').value || 'A - Pháº£i';
  $('B_left').textContent = $('B_p2').value || 'B - TrÃ¡i';
  $('B_right').textContent = $('B_p1').value || 'B - Pháº£i';
  $('teamAName').value = $('teamAName').value || 'TEAM A';
  $('teamBName').value = $('teamBName').value || 'TEAM B';
}

/* main: xá»­ lÃ½ nÃºt + Ä‘iá»ƒm cho 1 team */
function pointButton(team){
  if (!isMatchStarted){ alert('Báº¥m Báº®T Äáº¦U trÆ°á»›c khi ghi Ä‘iá»ƒm.'); return; }

  // Náº¿u team Ä‘ang giao => cá»™ng Ä‘iá»ƒm; náº¿u khÃ´ng Ä‘ang giao => Ä‘á»™i giao máº¥t quyá»n (chuyá»ƒn quyá»n sang Ä‘á»™i kia)
  if (team === servingTeam){
    // cá»™ng Ä‘iá»ƒm há»£p lá»‡
    if (team === 'A') scoreA++; else scoreB++;
    // má»—i láº§n Ä‘á»™i Ä‘ang giao ghi Ä‘iá»ƒm -> ngÆ°á»i giao Ä‘á»•i vá»‹ trÃ­ pháº£i/trÃ¡i
    servingPlayer = (servingPlayer === 1)?2:1;
    updateAll();
    checkWin();
  } else {
    // Ä‘á»™i khÃ´ng giao "ghi Ä‘iá»ƒm" -> thá»±c táº¿ lÃ  Ä‘á»™i Ä‘ang giao máº¥t lÆ°á»£t: chuyá»ƒn quyá»n giao sang team kia
    passServiceTo(team); // team param = Ä‘á»™i Ä‘Æ°á»£c chuyá»ƒn quyá»n (theo thao tÃ¡c)
  }
}

/* minus point (chá»‰nh tay) */
function minusPoint(team){
  if (team==='A' && scoreA>0) scoreA--;
  if (team==='B' && scoreB>0) scoreB--;
  updateAll();
}

/* chuyá»ƒn quyá»n giao do Ä‘á»™i nháº­n tháº¯ng rally (khÃ´ng Ä‘Æ°á»£c cá»™ng Ä‘iá»ƒm) */
function passServiceTo(winnerTeam){
  // winnerTeam lÃ  Ä‘á»™i tháº¯ng rally (nhÆ°ng khÃ´ng Ä‘Æ°á»£c cá»™ng Ä‘iá»ƒm vÃ¬ khÃ´ng giao)
  // nghÄ©a lÃ  the servingTeam Ä‘Ã£ máº¥t quyá»n, giá» winnerTeam sáº½ lÃ  servingTeam
  // náº¿u match Ä‘ang á»Ÿ initialPhase vÃ  initialServer máº¥t quyá»n -> sau láº§n nÃ y initialPhase=false
  if (isInitialPhase && servingTeam === initialServer){
    isInitialPhase = false; // sau láº§n máº¥t quyá»n Ä‘áº§u tiÃªn, má»i team sau sáº½ cÃ³ 2 quyá»n
  }
  servingTeam = winnerTeam; // chuyá»ƒn quyá»n
  serviceRights = 2;         // má»i láº§n chuyá»ƒn quyá»n (sau giai Ä‘oáº¡n Ä‘áº§u) => Ä‘á»™i má»›i cÃ³ 2 quyá»n giao
  servingPlayer = 1;         // ngÆ°á»i bÃªn pháº£i cá»§a Ä‘á»™i má»›i giao Ä‘áº§u tiÃªn
  updateAll();
}

/* thao tÃ¡c chuyá»ƒn quyá»n giao thá»§ cÃ´ng (dÃ¹ng Ä‘á»ƒ chá»‰nh) */
function swapServe(){
  servingTeam = (servingTeam === 'A')? 'B':'A';
  serviceRights = isInitialPhase && servingTeam===initialServer?1:2;
  servingPlayer = 1;
  updateAll();
}

/* Ä‘áº·t láº¡i vá»‹ trÃ­ (vá» máº·c Ä‘á»‹nh: right = ngÆ°á»i giao) */
function resetPositions(){
  servingPlayer = 1;
  updateAll();
}

/* hiá»ƒn thá»‹ tráº¡ng thÃ¡i (debug) */
function showState(){
  alert(`State:
Serving Team: ${servingTeam}
Serving Player: ${servingPlayer ===1 ? 'Pháº£i' : 'TrÃ¡i'}
Service Rights (hiá»‡n): ${serviceRights}
Score: ${scoreA} - ${scoreB}
Initial phase: ${isInitialPhase}`);
}

/* cáº­p nháº­t vá»‹ trÃ­ hiá»ƒn thá»‹ trÃªn sÃ¢n */
function updatePositionsVisual(){
  // Set classes for right/left to ensure visual shows who's á»Ÿ pháº£i
  // We'll place the "serving" player at the right position for their team.
  // For team A
  const aRight = $('A_right'), aLeft = $('A_left');
  const bRight = $('B_right'), bLeft = $('B_left');
  // Assign names already updated in updateNames()

  // highlight serving player with bolder border
  [aRight,aLeft,bRight,bLeft].forEach(el => el.style.boxShadow = '0 6px 14px rgba(0,0,0,0.06)');

  if (servingTeam === 'A'){
    if (servingPlayer === 1){ // A right is server
      aRight.style.transform = 'scale(1.02)';
      aRight.style.boxShadow = '0 10px 20px rgba(0,0,0,0.12)';
    } else {
      aLeft.style.transform = 'scale(1.02)';
      aLeft.style.boxShadow = '0 10px 20px rgba(0,0,0,0.12)';
    }
  } else {
    if (servingPlayer === 1){
      bRight.style.transform = 'scale(1.02)';
      bRight.style.boxShadow = '0 10px 20px rgba(0,0,0,0.12)';
    } else {
      bLeft.style.transform = 'scale(1.02)';
      bLeft.style.boxShadow = '0 10px 20px rgba(0,0,0,0.12)';
    }
  }

  // Reset transforms for non-serving players
  const all = [aRight,aLeft,bRight,bLeft];
  all.forEach(el=>{
    if (!el.style.transform) el.style.transform='';
  });
}

/* cáº­p nháº­t má»i hiá»ƒn thá»‹ */
function updateAll(){
  updateNames();
  $('scoreAmini').textContent = scoreA;
  $('scoreBmini').textContent = scoreB;
  $('scoreDisplay').textContent = `${scoreA} - ${scoreB}`;
  // serviceRights hiá»ƒn thá»‹: náº¿u Ä‘ang initial phase and servingTeam==initialServer => 1, else 2
  if (isInitialPhase && servingTeam===initialServer) serviceRights = 1;
  else serviceRights = 2;

  // main board: A - B - serviceRights (sá»‘ lÆ°á»£t giao Ä‘ang giao)
  $('mainBoard').textContent = `${scoreA} - ${scoreB} - ${serviceRights}`;

  // update player text with team names if provided
  const teamAname = $('teamAName').value || 'TEAM A';
  const teamBname = $('teamBName').value || 'TEAM B';
  // append small prefix to player names for clarity
  $('A_right').textContent = $('A_p1').value || (teamAname + ' P');
  $('A_left').textContent  = $('A_p2').value || (teamAname + ' L');
  $('B_right').textContent = $('B_p1').value || (teamBname + ' P');
  $('B_left').textContent  = $('B_p2').value || (teamBname + ' L');

  // Visual emphasis on server
  // Clear all transforms first
  ['A_right','A_left','B_right','B_left'].forEach(id=>{
    const el = $(id);
    el.style.transform = '';
    el.style.boxShadow = '0 6px 14px rgba(0,0,0,0.06)';
  });

  // Put the serving player on the 'right' spot visually by ensuring names correspond:
  // (We keep physical positions static but indicate server by scale & border)
  updatePositionsVisual();
}

/* kiá»ƒm tra Ä‘iá»u kiá»‡n tháº¯ng */
function checkWin(){
  const A = scoreA, B = scoreB;
  if (!winBy2){
    // cháº¡m Ä‘iá»ƒm
    if (A >= maxPoint){
      announceWin('A'); return;
    }
    if (B >= maxPoint){
      announceWin('B'); return;
    }
  } else {
    // cÃ¡ch 2
    if (A >= maxPoint && A - B >= 2){ announceWin('A'); return; }
    if (B >= maxPoint && B - A >= 2){ announceWin('B'); return; }
    // cap
    if (A >= (maxPoint===11?15:21)){ announceWin('A'); return; }
    if (B >= (maxPoint===11?15:21)){ announceWin('B'); return; }
  }
}

/* thÃ´ng bÃ¡o tháº¯ng */
function announceWin(team){
  const teamName = team === 'A' ? ($('teamAName').value || 'Äá»™i A') : ($('teamBName').value || 'Äá»™i B');
  alert('ğŸ‰ ' + teamName + ' tháº¯ng tráº­n! ğŸ‰');
  isMatchStarted = false;
}

/* Khi ngÆ°á»i dÃ¹ng báº¥m vÃ o Ä‘á»™i khÃ´ng Ä‘ang giao (Ä‘Ã£ mÃ´ táº£): Ä‘á»™i Ä‘ang giao máº¥t quyá»n
   => chuyá»ƒn quyá»n sang Ä‘á»™i kia vÃ  Ä‘á»™i kia cÃ³ 2 quyá»n (trá»« láº§n Ä‘áº§u special handled earlier) */
function passServiceToOpponent(){
  passServiceTo(servingTeam === 'A' ? 'B' : 'A');
}

/* init default */
updateAll();
</script>
</body>
</html>
